import{_ as i,c as a,o as e,au as t}from"./chunks/framework.DtUFc-jG.js";const d=JSON.parse('{"title":"Manage a collection","description":"","frontmatter":{},"headers":[],"relativePath":"guides/howtos/collection.md","filePath":"guides/howtos/collection.md"}'),n={name:"guides/howtos/collection.md"};function l(h,s,r,o,p,k){return e(),a("div",null,s[0]||(s[0]=[t(`<h1 id="manage-a-collection" tabindex="-1">Manage a collection <a class="header-anchor" href="#manage-a-collection" aria-label="Permalink to &quot;Manage a collection&quot;">​</a></h1><p>We previously covered how to <a href="./activity.html">create a new activity</a>, we will now detail how to setup an activity to manage a <a href="https://kalisio.github.io/kdk/api/core/components.html#collections" target="_blank" rel="noreferrer">collection</a> of <a href="https://kalisio.github.io/kdk/api/core/components/items.html" target="_blank" rel="noreferrer">items</a> hosted by a <a href="./service.html">service</a>.</p><p><strong>To be completed</strong></p><h2 id="sort-the-collection" tabindex="-1">Sort the collection <a class="header-anchor" href="#sort-the-collection" aria-label="Permalink to &quot;Sort the collection&quot;">​</a></h2><h3 id="make-the-collection-sortable" tabindex="-1">Make the collection sortable <a class="header-anchor" href="#make-the-collection-sortable" aria-label="Permalink to &quot;Make the collection sortable&quot;">​</a></h3><p>By default any service supports sorting based on FeathersJS <a href="https://feathersjs.com/api/databases/querying.html#sort" target="_blank" rel="noreferrer">common way for sorting</a>.</p><p>However, you will need to update your service model file (usually <code>api/src/models/serviceName.model.mongodb.js</code>) like this to support case insensitive sorting:</p><div class="language-js vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">export</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> default</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> function</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">app</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">options</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  ...</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  // Collation provided in query ensure sorting to be case insensitive w.r.t. user&#39;s language</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  // We built indices with collation to cover the most used languages, it requires different naming...</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  options.Model.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">createIndex</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">({ name: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> }, { name: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;name-en&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, collation: { locale: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;en&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, strength: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> } })</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  options.Model.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">createIndex</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">({ name: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> }, { name: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;name-fr&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, collation: { locale: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;fr&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, strength: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> } })</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  options.Model.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">createIndex</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">({ description: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> }, { name: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;description-en&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, collation: { locale: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;en&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, strength: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> } })</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  options.Model.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">createIndex</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">({ description: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> }, { name: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;description-fr&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, collation: { locale: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;fr&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, strength: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> } })</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre></div><h3 id="add-sorter-component" tabindex="-1">Add sorter component <a class="header-anchor" href="#add-sorter-component" aria-label="Permalink to &quot;Add sorter component&quot;">​</a></h3><p><strong>TODO</strong>: KSorter + layout configuration</p><h2 id="filter-the-collection" tabindex="-1">Filter the collection <a class="header-anchor" href="#filter-the-collection" aria-label="Permalink to &quot;Filter the collection&quot;">​</a></h2><p>By default any service supports filtering based on FeathersJS <a href="https://feathersjs.com/api/databases/querying.html#sort" target="_blank" rel="noreferrer">common way for querying</a>. However, it is often useful to be able to search the collection for items matching a <em>pattern</em>, e.g. in their names, instead of exact matching.</p><h3 id="make-the-collection-searchable" tabindex="-1">Make the collection searchable <a class="header-anchor" href="#make-the-collection-searchable" aria-label="Permalink to &quot;Make the collection searchable&quot;">​</a></h3><p>We rely on the (feathers-mongodb-fuzzy-search)[<a href="https://github.com/arve0/feathers-mongodb-fuzzy-search" target="_blank" rel="noreferrer">https://github.com/arve0/feathers-mongodb-fuzzy-search</a>] module to make the collection service support searching. Declare the fields of the item you&#39;d like to make searchable when using the provided hook. You can also add the KDK <code>diacriticSearch</code> hook to support <a href="https://connect.ebsco.com/s/article/What-is-diacritic-search" target="_blank" rel="noreferrer">diacritic search</a>.</p><p>Update your service hooks file (usually <code>api/src/services/serviceName/serviceName.hooks.js</code>) like this:</p><div class="language-js vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> fuzzySearch </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">from</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;feathers-mongodb-fuzzy-search&#39;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> { hooks </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">as</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> kdkCoreHooks } </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">from</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;@kalisio/kdk/core.api.js&#39;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">export</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> default</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  before: {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    find: [</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">      fuzzySearch</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">({ fields: [</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;name&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;description&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">] }),</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      kdkCoreHooks.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">diacriticSearch</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(),</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">      ...</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    ],</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    ...</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre></div><h3 id="add-filter-component" tabindex="-1">Add filter component <a class="header-anchor" href="#add-filter-component" aria-label="Permalink to &quot;Add filter component&quot;">​</a></h3><p><strong>TODO</strong>: KFilter + layout configuration</p>`,18)]))}const E=i(n,[["render",l]]);export{d as __pageData,E as default};
