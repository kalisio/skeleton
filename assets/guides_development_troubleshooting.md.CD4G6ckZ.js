import{_ as e,c as o,o as a,V as t}from"./chunks/framework.Q5AHJ25T.js";const m=JSON.parse('{"title":"Troubleshoot your app","description":"","frontmatter":{},"headers":[],"relativePath":"guides/development/troubleshooting.md","filePath":"guides/development/troubleshooting.md"}'),r={name:"guides/development/troubleshooting.md"},n=t(`<h1 id="troubleshoot-your-app" tabindex="-1">Troubleshoot your app <a class="header-anchor" href="#troubleshoot-your-app" aria-label="Permalink to &quot;Troubleshoot your app&quot;">​</a></h1><h2 id="linking-errors" tabindex="-1">Linking errors <a class="header-anchor" href="#linking-errors" aria-label="Permalink to &quot;Linking errors&quot;">​</a></h2><p>Due to the modular approach of the KDK we need to <a href="https://medium.com/@alexishevia/the-magic-behind-npm-link-d94dcb3a81af" target="_blank" rel="noreferrer">link</a> the modules and the applications according to the dependency tree when developing.</p><div class="tip custom-block"><p class="custom-block-title">TIP</p><p>Due to some <a href="http://codetunnel.io/npm-5-changes-to-npm-link/" target="_blank" rel="noreferrer">changes</a> in the way <code>npm</code> manages linked modules we prefer to use <a href="https://yarnpkg.com" target="_blank" rel="noreferrer">Yarn</a> as a package manager.</p></div><p>It appeared that when performing a new install, adding a new dependency, or launching two installs concurrently, some of the links can break, or some dependencies not being set to the right version, which raising different errors. As a workaround you will either need to:</p><ul><li>clear the yarn cache <code>yarn cache clean</code> (or <code>yarn cache clean module</code> to be more specific)</li><li>restore the broken links using commands like e.g. <code>yarn link @kalisio/kdk</code> in the broken applications</li><li>reinstall all dependencies using <code>rm -fr node_modules &amp;&amp; yarn install</code> or <code>yarn install --check-files</code> in broken modules/applications, and then restore the links as above</li></ul><div class="tip custom-block"><p class="custom-block-title">TIP</p><p>Errors are often visible when launching the app server but might come from an underlying module. For instance the <code>TypeError: (0 , commons_1.createDebug) is not a function at Object.&lt;anonymous&gt; </code> error often appears in modules, probably due to the fact incompatible versions of the same library (e.g. Feathers) are installed. So try first to reinstall and relink the modules before your app, and if you&#39;d like to see if a module is fine running its tests is usually a good indicator: <code>yarn mocha</code>.</p></div><h2 id="profiling" tabindex="-1">Profiling <a class="header-anchor" href="#profiling" aria-label="Permalink to &quot;Profiling&quot;">​</a></h2><p>In your local development environment you can usually use <a href="https://developers.google.com/web/tools/chrome-devtools/rendering-tools/js-execution" target="_blank" rel="noreferrer">Chrome DevTools</a>. However, it is trickier to perform profiling on remote production environments, here are the steps.</p><ol><li>Override the command used to launch your application to activate the <a href="https://nodejs.org/en/docs/guides/simple-profiling/" target="_blank" rel="noreferrer">Node.js V8 profiler</a>:</li></ol><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span>node --prof app.js</span></span></code></pre></div><ol start="2"><li>Once you have run your tests and recorded the profile, a file named like this <code>isolate-pid-1-v8.log</code> should appear in your working directory. Process it using the following commands to get either:</li></ol><ul><li><p>a &quot;human-readable&quot; file (txt)</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span>node --prof-process .\\isolate-0x49489f0-1-v8.log &gt; prof-processed.txt</span></span></code></pre></div></li><li><p>a &quot;machine-readable&quot; file (json)</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span>node --prof-process --preprocess -j .\\isolate-0x49489f0-1-v8.log &gt; prof-processed.json</span></span></code></pre></div></li></ul><ol start="3"><li>In order to identify bottlenecks in your app you can either:</li></ol><ul><li>Analyze the human-readable file</li><li>Install <a href="https://github.com/mapbox/flamebearer" target="_blank" rel="noreferrer">flamebearer</a> and generate the flame graph</li></ul><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span>npm install -g flamebearer</span></span>
<span class="line"><span>flamebearer prof-processed.json</span></span></code></pre></div><ul><li>Use the <a href="https://mapbox.github.io/flamebearer/" target="_blank" rel="noreferrer">online flame graph generator</a> and drag&#39;n&#39;drop your profile</li></ul>`,17),s=[n];function i(l,p,c,d,h,u){return a(),o("div",null,s)}const f=e(r,[["render",i]]);export{m as __pageData,f as default};
